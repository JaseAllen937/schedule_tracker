<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Momentum Tracker - Dashboard</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />
  </head>
  <body>
    <!-- Hamburger menu button (mobile only) -->
    <button class="hamburger" onclick="toggleSidebar()">â˜°</button>
    <div class="sidebar-overlay" onclick="closeSidebar()"></div>

    <div class="app-container">
      <!-- Sidebar -->
      <div class="sidebar" id="sidebar">
        <div class="logo">
          <div class="logo-icon">ğŸ”¥</div>
          <h2>Momentum</h2>
        </div>

        <div class="user-info">
          <div class="username" id="username">{{ username }}</div>
        </div>

        <ul class="nav-menu">
          <li class="nav-item">
            <a class="nav-link active" onclick="showSection('overview')">
              <span class="icon">ğŸ“Š</span>
              <span>Overview</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" onclick="showSection('building')">
              <span class="icon">ğŸ’ª</span>
              <span>Build Habits</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" onclick="showSection('breaking')">
              <span class="icon">ğŸš«</span>
              <span>Break Habits</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" onclick="showSection('goals')">
              <span class="icon">ğŸ¯</span>
              <span>Goals</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" onclick="showSection('calendar')">
              <span class="icon">ğŸ“…</span>
              <span>Calendar</span>
            </a>
          </li>
        </ul>

        <button
          class="logout-btn"
          style="margin-bottom: 10px; background: rgba(255, 255, 255, 0.15)"
          onclick="openModal('help-modal')"
        >
          â“ Confused?
        </button>

        <button class="logout-btn" onclick="logout()">Logout</button>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Overview Section -->
        <div class="page-section active" id="overview-section">
          <div class="page-header">
            <h1>Dashboard Overview</h1>
            <p>Track your progress at a glance</p>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-label">Current Streak</div>
              <div class="stat-value" id="stat-streak">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Longest Streak</div>
              <div class="stat-value" id="stat-longest">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Total Days</div>
              <div class="stat-value" id="stat-total">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Last Completed</div>
              <div class="stat-value" id="stat-last" style="font-size: 1.3em">
                Never
              </div>
            </div>
          </div>

          <div class="warning-banner" id="warning-banner">
            âš ï¸ YOUR STREAK IS IN DANGER! Complete your tasks today.
          </div>

          <!-- NEW: Daily Motivation Section -->
          <div class="motivation-section">
            <div class="motivation-header">
              <h3>âœï¸ Daily Motivation</h3>
              <div class="refresh-container">
                <button
                  class="refresh-btn"
                  id="refreshBtn"
                  onclick="refreshMotivation()"
                  title="Get new verse & quote"
                >
                  ğŸ”„ Refresh
                </button>
                <div class="loading-spinner" id="loadingSpinner"></div>
                <span class="loading-text" id="loadingText"
                  >Generating quotes...</span
                >
              </div>
            </div>
            <div class="motivation-grid">
              <div id="bible-verse-container"></div>
              <div id="quote-container"></div>
            </div>
          </div>

          <!-- NEW: Upcoming Deadlines Section -->
          <div class="deadlines-section">
            <div class="card-header">
              <h3>ğŸ“… Upcoming Deadlines</h3>
              <button class="add-btn" onclick="openAddDeadlineModal()">
                + Add Deadline
              </button>
            </div>
            <p style="color: #666; font-size: 0.9em; margin-bottom: 15px">
              Tasks with due dates that don't affect your streak
            </p>
            <div id="deadlines-container"></div>
          </div>

          <div class="progress-section">
            <h3 style="margin-bottom: 20px; color: #1e3c72">Your Progress</h3>
            <div class="progress-bar-container">
              <div
                class="progress-bar-fill"
                id="progress-bar"
                style="width: 0%"
              ></div>
            </div>
            <div id="history-display"></div>
          </div>
        </div>

        <!-- Build Habits Section -->
        <div class="page-section" id="building-section">
          <div class="page-header">
            <h1>Build Good Habits</h1>
            <p>Your daily non-negotiables for success</p>
          </div>

          <div class="warning-banner" id="building-warning">
            âš ï¸ Complete all tasks today or lose your streak!
          </div>

          <div class="categories-container" id="categories-container"></div>

          <div class="add-category-btn" onclick="openAddCategoryModal()">
            <div style="font-size: 2em; margin-bottom: 10px">â•</div>
            <div>Add New Category</div>
          </div>

          <div class="complete-day-container">
            <button
              class="complete-btn"
              id="complete-btn"
              onclick="completeDay()"
            >
              âœ… COMPLETE TODAY
            </button>
            <div style="text-align: center; margin: 20px 0">
              <button
                class="btn btn-secondary"
                onclick="clearAllCheckboxes()"
                style="padding: 12px 30px; font-size: 1em"
              >
                â†» Clear All Checkboxes
              </button>
            </div>
          </div>
        </div>

        <!-- Break Habits Section -->
        <div class="page-section" id="breaking-section">
          <div class="page-header">
            <h1>Break Bad Habits</h1>
            <p>Track your sobriety and stay accountable</p>
          </div>

          <button
            class="add-btn"
            style="margin-bottom: 20px"
            onclick="openAddHabitModal()"
          >
            + Track New Habit
          </button>

          <div id="bad-habits-list"></div>
        </div>

        <!-- Goals Section -->
        <div class="page-section" id="goals-section">
          <div class="page-header">
            <h1>Goals & Milestones</h1>
            <p>What you're working towards</p>
          </div>

          <div class="content-grid">
            <div class="card">
              <div class="card-header">
                <h3>30-Day Milestones</h3>
                <button class="add-btn" onclick="openAddMilestoneModal()">
                  + Add
                </button>
              </div>
              <p style="color: #666; font-size: 0.9em; margin-bottom: 15px">
                Personal goals and achievements
              </p>
              <ul class="item-list" id="milestones-list"></ul>
            </div>

            <div class="card">
              <div class="card-header">
                <h3>Ultimate Goal</h3>
                <button class="add-btn" onclick="openEditGoalModal()">
                  Edit
                </button>
              </div>
              <div id="goal-display"></div>
            </div>
          </div>
        </div>

        <!-- Calendar Section -->
        <div class="page-section" id="calendar-section">
          <div class="page-header">
            <h1>Calendar View</h1>
            <p>Visualize your progress and upcoming deadlines</p>
          </div>

          <div class="calendar-container">
            <!-- Calendar Navigation -->
            <div class="calendar-nav">
              <button class="calendar-nav-btn" onclick="changeMonth(-1)">
                â®
              </button>
              <h2 id="calendar-month-year">January 2026</h2>
              <button class="calendar-nav-btn" onclick="changeMonth(1)">
                â¯
              </button>
            </div>

            <!-- Calendar Grid -->
            <div class="calendar-grid" id="calendar-grid">
              <div class="calendar-day-header">Sun</div>
              <div class="calendar-day-header">Mon</div>
              <div class="calendar-day-header">Tue</div>
              <div class="calendar-day-header">Wed</div>
              <div class="calendar-day-header">Thu</div>
              <div class="calendar-day-header">Fri</div>
              <div class="calendar-day-header">Sat</div>
              <!-- Calendar days will be inserted directly here by JavaScript -->
            </div>

            <!-- Calendar Legend -->
            <div class="calendar-legend">
              <div class="legend-item">
                <div class="legend-dot completed-dot"></div>
                <span>Day Completed</span>
              </div>
              <div class="legend-item">
                <div class="legend-dot deadline-dot"></div>
                <span>Deadline Due</span>
              </div>
              <div class="legend-item">
                <div class="legend-dot milestone-dot"></div>
                <span>Milestone</span>
              </div>
              <div class="legend-item">
                <div class="legend-dot today-dot"></div>
                <span>Today</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Calendar Day Details Modal -->
    <div id="calendar-day-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-header" id="calendar-modal-title">January 21, 2026</h3>
        <div id="calendar-modal-content"></div>
        <div class="modal-actions">
          <button
            class="btn btn-primary"
            style="width: 100%"
            onclick="closeModal('calendar-day-modal')"
          >
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- Add Task Modal -->
    <div id="task-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-header">Add Task</h3>
        <div class="form-group">
          <label>Category</label>
          <select id="task-category-select"></select>
        </div>
        <div class="form-group">
          <label>Task Description</label>
          <input
            type="text"
            id="task-input"
            placeholder="e.g., 30 min: Study for exam"
          />
        </div>
        <div class="form-group">
          <label
            style="
              display: flex;
              align-items: center;
              gap: 10px;
              cursor: pointer;
            "
          >
            <input
              type="checkbox"
              id="task-recurring"
              style="width: 20px; height: 20px"
            />
            <span>ğŸ” Repeat this task daily</span>
          </label>
          <p style="font-size: 0.85em; color: #666; margin-top: 5px">
            Recurring tasks stay in your list and reset each day
          </p>
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="addTask()">Add Task</button>
          <button class="btn btn-secondary" onclick="closeModal('task-modal')">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Add Category Modal -->
    <div id="category-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-header">Add Category</h3>
        <div class="form-group">
          <label>Category Name</label>
          <input
            type="text"
            id="category-name"
            placeholder="e.g., Personal Development"
          />
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="addCategory()">
            Add Category
          </button>
          <button
            class="btn btn-secondary"
            onclick="closeModal('category-modal')"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- NEW: Add Deadline Modal -->
    <div id="deadline-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-header">Add Deadline Task</h3>
        <div class="form-group">
          <label>Task Description</label>
          <input
            type="text"
            id="deadline-input"
            placeholder="e.g., Submit essay, Read Chapter 5"
          />
        </div>
        <div class="form-group">
          <label>Due Date</label>
          <input type="date" id="deadline-date" />
        </div>
        <div class="form-group">
          <label>Category (Optional)</label>
          <select id="deadline-category-select">
            <option value="">None</option>
          </select>
        </div>
        <div class="form-group">
          <label>Priority</label>
          <select id="deadline-priority">
            <option value="low">ğŸ”¹ Low</option>
            <option value="medium" selected>ğŸ”¸ Medium</option>
            <option value="high">ğŸ”º High</option>
          </select>
        </div>
        <p style="font-size: 0.85em; color: #666; margin-bottom: 15px">
          â„¹ï¸ Deadline tasks don't affect your streak - they're just for tracking
          due dates
        </p>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="addDeadline()">
            Add Deadline
          </button>
          <button
            class="btn btn-secondary"
            onclick="closeModal('deadline-modal')"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Add Bad Habit Modal -->
    <div id="habit-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-header">Track Bad Habit</h3>
        <div class="form-group">
          <label>What habit are you breaking?</label>
          <input
            type="text"
            id="habit-name"
            placeholder="e.g., Pornography, Drugs, Alcohol"
          />
        </div>
        <div class="form-group">
          <label>Clean Since Date</label>
          <input type="date" id="habit-date" />
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="addBadHabit()">
            Start Tracking
          </button>
          <button class="btn btn-secondary" onclick="closeModal('habit-modal')">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Add Milestone Modal -->
    <div id="milestone-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-header">Add Milestone</h3>
        <div class="form-group">
          <label>Milestone</label>
          <input
            type="text"
            id="milestone-input"
            placeholder="e.g., Hit 100-day streak, Launch product"
          />
        </div>
        <div class="form-group">
          <label>Target Date</label>
          <input type="date" id="milestone-date" />
        </div>
        <p style="font-size: 0.85em; color: #666; margin-bottom: 15px">
          â„¹ï¸ Milestones are personal goals that don't have daily urgency
        </p>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="addMilestone()">
            Add Milestone
          </button>
          <button
            class="btn btn-secondary"
            onclick="closeModal('milestone-modal')"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Edit Goal Modal -->
    <div id="goal-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-header">Set Ultimate Goal</h3>
        <div class="form-group">
          <label>What's your end goal?</label>
          <textarea
            id="goal-input"
            rows="3"
            placeholder="e.g., $1,000/month from AI products by Feb 15"
          ></textarea>
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="saveGoal()">
            Save Goal
          </button>
          <button class="btn btn-secondary" onclick="closeModal('goal-modal')">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal">
      <div class="modal-content" style="max-width: 600px">
        <h3 class="modal-header">ğŸ“– How to Use Momentum Tracker</h3>

        <div style="line-height: 1.8">
          <h4 style="color: #1e3c72; margin-top: 20px">
            ğŸ—‚ï¸ Step 1: Build Your Daily System
          </h4>
          <p>1. Go to <strong>"Build Habits"</strong></p>
          <p>
            2. Click <strong>"Add New Category"</strong> (e.g., School, Fitness,
            Health)
          </p>
          <p>
            3. Click <strong>"+ Add Task"</strong> to add specific daily tasks
          </p>
          <p style="margin-left: 20px">Example: "30 min: Study French"</p>

          <h4 style="color: #1e3c72; margin-top: 20px">
            âœ… Step 2: Complete Your Day
          </h4>
          <p>1. Check off each task as you complete it (âœ“)</p>
          <p>
            2. When ALL tasks are done, click the green
            <strong>"COMPLETE TODAY"</strong> button
          </p>
          <p>3. Your streak increases by 1 day!</p>

          <h4 style="color: #1e3c72; margin-top: 20px">
            ğŸ“… Step 3: Track Deadlines (Optional)
          </h4>
          <p>1. Go to <strong>"Overview"</strong></p>
          <p>2. Scroll to <strong>"Upcoming Deadlines"</strong></p>
          <p>3. Click <strong>"+ Add Deadline"</strong></p>
          <p>4. Set task, due date, and priority</p>
          <p>
            5. These DON'T affect your streak - just help you stay organized!
          </p>

          <h4 style="color: #ff6b6b; margin-top: 20px">
            ğŸš« Step 4: Track Bad Habits (Optional)
          </h4>
          <p>1. Go to <strong>"Break Habits"</strong></p>
          <p>2. Click <strong>"+ Track New Habit"</strong></p>
          <p>3. Enter what you're quitting (e.g., "Pornography", "Smoking")</p>
          <p>4. Click "Mark Relapse" if you slip up - it resets the counter</p>

          <h4 style="color: #1e3c72; margin-top: 20px">
            ğŸ¯ Step 5: Set Goals (Optional)
          </h4>
          <p>â€¢ Add 30-day milestones with target dates</p>
          <p>â€¢ Set your ultimate end goal (e.g., "$1,000/month by March")</p>

          <h4 style="color: #1e3c72; margin-top: 20px">âš ï¸ Important Rules:</h4>
          <p>â€¢ You can only complete a day ONCE per 24 hours</p>
          <p>â€¢ If you miss a day, your streak resets to 0</p>
          <p>â€¢ You must check ALL tasks before completing the day</p>
          <p>â€¢ Task checkboxes reset every day after completion</p>
          <p>â€¢ Deadline tasks DON'T affect your streak</p>

          <h4 style="color: #10b981; margin-top: 20px">ğŸ’¡ Pro Tips:</h4>
          <p>â€¢ Start with 2-3 tasks max - don't overwhelm yourself</p>
          <p>â€¢ Make tasks specific and time-bound</p>
          <p>â€¢ Complete your hardest task first thing in the morning</p>
          <p>â€¢ Your longest streak proves what you're capable of</p>
          <p>â€¢ Use deadlines for school/work tasks that have due dates</p>
        </div>

        <div class="modal-actions">
          <button
            class="btn btn-primary"
            style="width: 100%"
            onclick="closeModal('help-modal')"
          >
            Got It!
          </button>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
